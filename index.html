<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WebSockets &mdash; websockets 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="websockets 0.1 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">websockets 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-websockets"></span><div class="section" id="websockets">
<h1>WebSockets<a class="headerlink" href="#websockets" title="Permalink to this headline">¶</a></h1>
<p><tt class="docutils literal"><span class="pre">websockets</span></tt> is an implementation of <a class="reference external" href="http://tools.ietf.org/html/rfc6455">RFC 6455</a>, the WebSocket protocol,
with a focus on simplicity and correctness.</p>
<p>It relies on the <a class="reference external" href="http://code.google.com/p/tulip/">Tulip</a> library, which prefigurates Python&#8217;s <a class="reference external" href="http://www.python.org/dev/peps/pep-3156/">asynchronous
IO support</a>, and requires Python ≥ 3.3.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p id="server-example">Here&#8217;s a WebSocket server example. It reads a name from the client and sends a
greeting.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tulip</span>
<span class="kn">import</span> <span class="nn">websockets</span>

<span class="nd">@tulip.coroutine</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">websocket</span><span class="p">,</span> <span class="n">uri</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="n">websocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;Hello {}!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="n">websockets</span><span class="o">.</span><span class="n">serve</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span> <span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">8765</span><span class="p">)</span>

<span class="n">tulip</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
</pre></div>
</div>
<p id="client-example">Here&#8217;s a corresponding client example.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tulip</span>
<span class="kn">import</span> <span class="nn">websockets</span>

<span class="nd">@tulip.coroutine</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="n">websocket</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">websockets</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;ws://localhost:8765/&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;What&#39;s your name? &quot;</span><span class="p">)</span>
    <span class="n">websocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;&gt; {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="k">yield from</span> <span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;&lt; {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">greeting</span><span class="p">))</span>
    <span class="k">yield from</span> <span class="n">websocket</span><span class="o">.</span><span class="n">wait_close</span><span class="p">()</span>

<span class="n">tulip</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">hello</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="design">
<h2>Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h2>
<p>The WebSocket protocol contains two phases:</p>
<ol class="arabic simple">
<li>An opening handshake, in the form of an HTTP Upgrade request;</li>
<li>Data transfer, as framed messages, ending with a closing handshake.</li>
</ol>
<p>The first phase is designed to integrate with existing HTTP software.
<tt class="docutils literal"><span class="pre">websockets</span></tt> provides functions to build and validate the request and
response headers.</p>
<p>The second phase is the core of the WebSocket protocol. <tt class="docutils literal"><span class="pre">websockets</span></tt>
provides a standalone implementation on top of Tulip with a very simple API.</p>
<p><tt class="docutils literal"><span class="pre">websockets</span></tt> also contains sample client and server implementations showing
how these pieces fit together.</p>
<p>The public APIs are described below. For convenience, they can be imported
directly from the <a class="reference internal" href="#module-websockets" title="websockets"><tt class="xref py py-mod docutils literal"><span class="pre">websockets</span></tt></a> package, unless noted otherwise.</p>
</div>
<div class="section" id="main-apis">
<h2>Main APIs<a class="headerlink" href="#main-apis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-websockets.handshake">
<span id="opening-handshake"></span><h3>Opening handshake<a class="headerlink" href="#module-websockets.handshake" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.handshake" title="websockets.handshake"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.handshake</span></tt></a> module deals with the WebSocket opening
handshake according to <a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-4">section 4 of RFC 6455</a>.</p>
<p>It provides functions to implement the handshake with any existing HTTP
library. You must pass to these functions:</p>
<ul class="simple">
<li>A <cite>set_header</cite> function accepting a header name and a header value,</li>
<li>A <cite>get_header</cite> function accepting a header name and returning the header
value.</li>
</ul>
<p>The inputs and outputs of <cite>get_header</cite> and <cite>set_header</cite> are <a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a>
objects containing only ASCII characters.</p>
<p>Some checks cannot be performed because they depend too much on the
context; instead, they&#8217;re documented below.</p>
<p>To accept a connection, a server must:</p>
<ul class="simple">
<li>Read the request, check that the method is GET, and check the headers with
<a class="reference internal" href="#websockets.handshake.check_request" title="websockets.handshake.check_request"><tt class="xref py py-func docutils literal"><span class="pre">check_request()</span></tt></a>,</li>
<li>Send a 101 response to the client with the headers created by
<a class="reference internal" href="#websockets.handshake.build_response" title="websockets.handshake.build_response"><tt class="xref py py-func docutils literal"><span class="pre">build_response()</span></tt></a> if the request is valid; otherwise, send a 400.</li>
</ul>
<p>To open a connection, a client must:</p>
<ul class="simple">
<li>Send a GET request to the server with the headers created by
<a class="reference internal" href="#websockets.handshake.build_request" title="websockets.handshake.build_request"><tt class="xref py py-func docutils literal"><span class="pre">build_request()</span></tt></a>,</li>
<li>Read the response, check that the status code is 101, and check the headers
with <a class="reference internal" href="#websockets.handshake.check_response" title="websockets.handshake.check_response"><tt class="xref py py-func docutils literal"><span class="pre">check_response()</span></tt></a>.</li>
</ul>
<dl class="exception">
<dt id="websockets.handshake.InvalidHandshake">
<em class="property">exception </em><tt class="descclassname">websockets.handshake.</tt><tt class="descname">InvalidHandshake</tt><a class="reference internal" href="_modules/websockets/handshake.html#InvalidHandshake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.handshake.InvalidHandshake" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a handshake request or response is invalid.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.handshake.build_request">
<tt class="descclassname">websockets.handshake.</tt><tt class="descname">build_request</tt><big>(</big><em>set_header</em><big>)</big><a class="reference internal" href="_modules/websockets/handshake.html#build_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.handshake.build_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a handshake request to send to the server.</p>
<p>Return the <cite>key</cite> which must be passed to <a class="reference internal" href="#websockets.handshake.check_response" title="websockets.handshake.check_response"><tt class="xref py py-func docutils literal"><span class="pre">check_response()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.handshake.check_request">
<tt class="descclassname">websockets.handshake.</tt><tt class="descname">check_request</tt><big>(</big><em>get_header</em><big>)</big><a class="reference internal" href="_modules/websockets/handshake.html#check_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.handshake.check_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a handshake request received from the client.</p>
<p>If the handshake is valid, this function returns the <cite>key</cite> which must be
passed to <a class="reference internal" href="#websockets.handshake.build_response" title="websockets.handshake.build_response"><tt class="xref py py-func docutils literal"><span class="pre">build_response()</span></tt></a>.</p>
<p>Otherwise, it raises an <a class="reference internal" href="#websockets.handshake.InvalidHandshake" title="websockets.handshake.InvalidHandshake"><tt class="xref py py-exc docutils literal"><span class="pre">InvalidHandshake</span></tt></a> exception and the server
must return an error, usually 400 Bad Request.</p>
<p>This function doesn&#8217;t verify that the request is an HTTP/1.1 or higher GET
request and doesn&#8217;t perform Host and Origin checks. These controls are
usually performed earlier in the HTTP request handling code. They&#8217;re the
responsibility of the caller.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.handshake.build_response">
<tt class="descclassname">websockets.handshake.</tt><tt class="descname">build_response</tt><big>(</big><em>set_header</em>, <em>key</em><big>)</big><a class="reference internal" href="_modules/websockets/handshake.html#build_response"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.handshake.build_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a handshake response to send to the client.</p>
<p><cite>key</cite> comes from <a class="reference internal" href="#websockets.handshake.check_request" title="websockets.handshake.check_request"><tt class="xref py py-func docutils literal"><span class="pre">check_request()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.handshake.check_response">
<tt class="descclassname">websockets.handshake.</tt><tt class="descname">check_response</tt><big>(</big><em>get_header</em>, <em>key</em><big>)</big><a class="reference internal" href="_modules/websockets/handshake.html#check_response"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.handshake.check_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a handshake response received from the server.</p>
<p><cite>key</cite> comes from <a class="reference internal" href="#websockets.handshake.build_request" title="websockets.handshake.build_request"><tt class="xref py py-func docutils literal"><span class="pre">build_request()</span></tt></a>.</p>
<p>If the handshake is valid, this function returns <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>Otherwise, it raises an <a class="reference internal" href="#websockets.handshake.InvalidHandshake" title="websockets.handshake.InvalidHandshake"><tt class="xref py py-exc docutils literal"><span class="pre">InvalidHandshake</span></tt></a> exception.</p>
<p>This function doesn&#8217;t verify that the response is an HTTP/1.1 or higher
response with a 101 status code. These controls are the responsibility of
the caller.</p>
</dd></dl>

</div>
<div class="section" id="module-websockets.framing">
<span id="data-transfer"></span><h3>Data transfer<a class="headerlink" href="#module-websockets.framing" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.framing" title="websockets.framing"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.framing</span></tt></a> module implements data framing as specified in
<a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-4">sections 5 to 8 of RFC 6455</a>.</p>
<dl class="class">
<dt id="websockets.framing.WebSocketProtocol">
<em class="property">class </em><tt class="descclassname">websockets.framing.</tt><tt class="descname">WebSocketProtocol</tt><big>(</big><em>is_client=False</em><big>)</big><a class="reference internal" href="_modules/websockets/framing.html#WebSocketProtocol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.framing.WebSocketProtocol" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements WebSocket framing as a Tulip protocol.</p>
<p>It assumes that the opening handshake and the upgrade from HTTP have been
completed. It deals with with sending and receiving data, and with the
closing handshake.</p>
<p>It implements the server side behavior by default. To obtain the client
side behavior, instantiate it with <cite>is_client=True</cite>.</p>
<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.close">
<tt class="descname">close</tt><big>(</big><em>data=b''</em><big>)</big><a class="reference internal" href="_modules/websockets/framing.html#WebSocketProtocol.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.framing.WebSocketProtocol.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This coroutine performs the closing handshake.</p>
<p>It waits for the other end to complete the handshake. It doesn&#8217;t do
anything once the connection is closed.</p>
<p>This is the expected way to terminate a connection on the server side.</p>
<p>Status codes aren&#8217;t implemented, but they can be passed in <cite>data</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.ping">
<tt class="descname">ping</tt><big>(</big><em>data=b''</em><big>)</big><a class="headerlink" href="#websockets.framing.WebSocketProtocol.ping" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a ping.</p>
<p>A ping may serve as a keepalive.</p>
</dd></dl>

<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.pong">
<tt class="descname">pong</tt><big>(</big><em>data=b''</em><big>)</big><a class="headerlink" href="#websockets.framing.WebSocketProtocol.pong" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a pong.</p>
<p>An unsolicited pong may serve as a unidirectional heartbeat.</p>
</dd></dl>

<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.recv">
<tt class="descname">recv</tt><big>(</big><big>)</big><a class="headerlink" href="#websockets.framing.WebSocketProtocol.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>This coroutine receives the next message.</p>
<p>It returns a <a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a> for a text frame and <tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt> for a
binary frame.</p>
<p>It raises <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.3)"><tt class="xref py py-exc docutils literal"><span class="pre">IOError</span></tt></a> once the connection is closed.</p>
</dd></dl>

<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.send">
<tt class="descname">send</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#websockets.framing.WebSocketProtocol.send" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sends a message.</p>
<p>It sends a <a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a> as a text frame and <tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt> as a binary
frame.</p>
<p>It raises a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.3)"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> for other inputs and <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.3)"><tt class="xref py py-exc docutils literal"><span class="pre">IOError</span></tt></a> once
the connection is closed.</p>
</dd></dl>

<dl class="method">
<dt id="websockets.framing.WebSocketProtocol.wait_close">
<tt class="descname">wait_close</tt><big>(</big><big>)</big><a class="headerlink" href="#websockets.framing.WebSocketProtocol.wait_close" title="Permalink to this definition">¶</a></dt>
<dd><p>This coroutine waits for the closing handshake.</p>
<p>It doesn&#8217;t do anything once the connection is closed.</p>
<p>This is the expected way to terminate a connection on the client side.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-websockets.uri">
<span id="uri-parser"></span><h3>URI parser<a class="headerlink" href="#module-websockets.uri" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.uri" title="websockets.uri"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.uri</span></tt></a> module implements parsing of WebSocket URIs
according to <a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-3">section 3 of RFC 6455</a>.</p>
<dl class="exception">
<dt id="websockets.uri.InvalidURI">
<em class="property">exception </em><tt class="descclassname">websockets.uri.</tt><tt class="descname">InvalidURI</tt><a class="reference internal" href="_modules/websockets/uri.html#InvalidURI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.uri.InvalidURI" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when an URI is invalid.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.uri.parse_uri">
<tt class="descclassname">websockets.uri.</tt><tt class="descname">parse_uri</tt><big>(</big><em>uri</em><big>)</big><a class="reference internal" href="_modules/websockets/uri.html#parse_uri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.uri.parse_uri" title="Permalink to this definition">¶</a></dt>
<dd><p>This function parses and validates a WebSocket URI.</p>
<p>If the URI is valid, it returns a namedtuple <cite>(secure, host, port,
resource_name)</cite></p>
<p>Otherwise, it raises an <a class="reference internal" href="#websockets.uri.InvalidURI" title="websockets.uri.InvalidURI"><tt class="xref py py-exc docutils literal"><span class="pre">InvalidURI</span></tt></a> exception.</p>
</dd></dl>

</div>
</div>
<div class="section" id="implementations">
<h2>Implementations<a class="headerlink" href="#implementations" title="Permalink to this headline">¶</a></h2>
<p>These sample implementations demonstrate how to tie together the opening
handshake and data transfer APIs.</p>
<div class="section" id="module-websockets.server">
<span id="server"></span><h3>Server<a class="headerlink" href="#module-websockets.server" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.server" title="websockets.server"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.server</span></tt></a> module contains a sample WebSocket server
implementation.</p>
<dl class="function">
<dt id="websockets.server.serve">
<tt class="descclassname">websockets.server.</tt><tt class="descname">serve</tt><big>(</big><em>ws_handler</em>, <em>host=None</em>, <em>port=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/websockets/server.html#serve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.server.serve" title="Permalink to this definition">¶</a></dt>
<dd><p>This task starts a WebSocket server.</p>
<p><cite>ws_handler</cite> is the WebSocket handler. It must be a coroutine accepting
two arguments: a <a class="reference internal" href="#websockets.framing.WebSocketProtocol" title="websockets.framing.WebSocketProtocol"><tt class="xref py py-class docutils literal"><span class="pre">WebSocketProtocol</span></tt></a> and the
request URI. The <cite>host</cite> and <cite>port</cite> arguments and other keyword arguments
are passed to the event loop&#8217;s <tt class="docutils literal"><span class="pre">start_serving</span></tt> method.</p>
<p>Whenever a client connects, the server accepts the connection, creates a
<a class="reference internal" href="#websockets.framing.WebSocketProtocol" title="websockets.framing.WebSocketProtocol"><tt class="xref py py-class docutils literal"><span class="pre">WebSocketProtocol</span></tt></a>, performs the opening
handshake, and delegates to the WebSocket handler. Once the handler
completes, the server performs the closing handshake and closes the
connection.</p>
</dd></dl>

<p>See also the <a class="reference internal" href="#server-example"><em>example</em></a> above.</p>
</div>
<div class="section" id="module-websockets.client">
<span id="client"></span><h3>Client<a class="headerlink" href="#module-websockets.client" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.client" title="websockets.client"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.client</span></tt></a> module contains a sample WebSocket client
implementation.</p>
<dl class="function">
<dt id="websockets.client.connect">
<tt class="descclassname">websockets.client.</tt><tt class="descname">connect</tt><big>(</big><em>uri</em><big>)</big><a class="reference internal" href="_modules/websockets/client.html#connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.client.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>This coroutine connects to a WebSocket server and perfoms the handshake.</p>
<p>It returns a <a class="reference internal" href="#websockets.framing.WebSocketProtocol" title="websockets.framing.WebSocketProtocol"><tt class="xref py py-class docutils literal"><span class="pre">WebSocketProtocol</span></tt></a> which can then
be used to send and receive messages.</p>
<p>It raises <a class="reference internal" href="#websockets.uri.InvalidURI" title="websockets.uri.InvalidURI"><tt class="xref py py-exc docutils literal"><span class="pre">InvalidURI</span></tt></a> if <cite>uri</cite> is invalid and
<a class="reference internal" href="#websockets.handshake.InvalidHandshake" title="websockets.handshake.InvalidHandshake"><tt class="xref py py-exc docutils literal"><span class="pre">InvalidHandshake</span></tt></a> if the handshake fails.</p>
<p>Clients shouldn&#8217;t close the WebSocket connection. Instead, they should
wait with <a class="reference internal" href="#websockets.framing.WebSocketProtocol.wait_close" title="websockets.framing.WebSocketProtocol.wait_close"><tt class="xref py py-meth docutils literal"><span class="pre">wait_close()</span></tt></a> until
the server performs the closing handshake.</p>
<p><a class="reference internal" href="#websockets.client.connect" title="websockets.client.connect"><tt class="xref py py-func docutils literal"><span class="pre">connect()</span></tt></a> implements the sequence called &#8220;Establish a WebSocket
Connection&#8221; in RFC 6455, except for the following requirements:</p>
<ul class="simple">
<li>&#8220;There MUST be no more than one connection in a CONNECTING state.&#8221;</li>
<li>&#8220;Clients MUST use the Server Name Indication extension.&#8221; (Tulip doesn&#8217;t
support passing a <tt class="docutils literal"><span class="pre">server_hostname</span></tt> argument to <tt class="docutils literal"><span class="pre">wrap_socket()</span></tt>.)</li>
</ul>
</dd></dl>

<p>See also the <a class="reference internal" href="#client-example"><em>example</em></a> above.</p>
</div>
<div class="section" id="module-websockets.http">
<span id="utilities"></span><h3>Utilities<a class="headerlink" href="#module-websockets.http" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#module-websockets.http" title="websockets.http"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.http</span></tt></a> module provides HTTP parsing functions. They&#8217;re
merely adequate for the WebSocket handshake messages. They&#8217;re used by the
sample client and servers.</p>
<p>These functions cannot be imported from <a class="reference internal" href="#module-websockets" title="websockets"><tt class="xref py py-mod docutils literal"><span class="pre">websockets</span></tt></a>; they must be
imported from <a class="reference internal" href="#module-websockets.http" title="websockets.http"><tt class="xref py py-mod docutils literal"><span class="pre">websockets.http</span></tt></a>.</p>
<dl class="function">
<dt id="websockets.http.read_request">
<tt class="descclassname">websockets.http.</tt><tt class="descname">read_request</tt><big>(</big><em>stream</em><big>)</big><a class="reference internal" href="_modules/websockets/http.html#read_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.http.read_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an HTTP/1.1 request from <cite>stream</cite>.</p>
<p>Return <cite>(uri, headers)</cite> where <cite>uri</cite> is a <a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a> and <cite>headers</cite>
is a <a class="reference external" href="http://docs.python.org/3/library/email.message.html#email.message.Message" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt></a>; <cite>uri</cite> isn&#8217;t URL-decoded.</p>
<p>Raise an exception if the request isn&#8217;t well formatted.</p>
<p>The request is assumed not to contain a body.</p>
</dd></dl>

<dl class="function">
<dt id="websockets.http.read_response">
<tt class="descclassname">websockets.http.</tt><tt class="descname">read_response</tt><big>(</big><em>stream</em><big>)</big><a class="reference internal" href="_modules/websockets/http.html#read_response"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#websockets.http.read_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an HTTP/1.1 response from <cite>stream</cite>.</p>
<p>Return <cite>(status, headers)</cite> where <cite>status</cite> is a <tt class="xref py py-class docutils literal"><span class="pre">int</span></tt> and
<cite>headers</cite> is a <a class="reference external" href="http://docs.python.org/3/library/email.message.html#email.message.Message" title="(in Python v3.3)"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt></a>.</p>
<p>Raise an exception if the request isn&#8217;t well formatted.</p>
<p>The response is assumed not to contain a body.</p>
</dd></dl>

</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<p>The following parts of RFC 6455 aren&#8217;t implemented:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-1.9">Subprotocols</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-9">Extensions</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6455#section-7.4">Status codes</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">WebSockets</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#design">Design</a></li>
<li><a class="reference internal" href="#main-apis">Main APIs</a><ul>
<li><a class="reference internal" href="#module-websockets.handshake">Opening handshake</a></li>
<li><a class="reference internal" href="#module-websockets.framing">Data transfer</a></li>
<li><a class="reference internal" href="#module-websockets.uri">URI parser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementations">Implementations</a><ul>
<li><a class="reference internal" href="#module-websockets.server">Server</a></li>
<li><a class="reference internal" href="#module-websockets.client">Client</a></li>
<li><a class="reference internal" href="#module-websockets.http">Utilities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">websockets 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Aymeric Augustin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>